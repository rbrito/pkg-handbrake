From f18f1e71e8c48e7d4fbcc3879e9b2515422f3999 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Rog=C3=A9rio=20Brito?= <rbrito@ime.usp.br>
Date: Fri, 22 Jun 2012 13:11:10 -0300
Subject: [PATCH] libhb: Fix erroneous memcpy used with overlapping memory
 locations.
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

This was discovered while running ghb under valgrind.

Signed-off-by: Rog√©rio Brito <rbrito@ime.usp.br>
---
 libhb/deca52.c |    2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/libhb/deca52.c b/libhb/deca52.c
index a8d537d..d137a96 100644
--- a/libhb/deca52.c
+++ b/libhb/deca52.c
@@ -374,7 +374,7 @@ static int deca52BSInfo( hb_work_object_t *w, const hb_buffer_t *b,
             // discard enough bytes from the front of the buffer to make
             // room for the new stuff
             int newlen = sizeof(w->audio->priv.config.a52.buf) - blen;
-            memcpy( buf, buf + len - newlen, newlen );
+            memmove( buf, buf + len - newlen, newlen );
             len = newlen;
         }
     }
-- 
1.7.10

